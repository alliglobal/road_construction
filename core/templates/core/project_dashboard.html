

{% extends 'core/base.html' %}
{% load static %}
{% block content %}

{% comment %} <pre>
Labels: {{ chart_labels }}
Percents: {{ chart_percents }}
</pre> {% endcomment %}

<h4 class="mb-3">Dashboard dá»± Ã¡n: {{ project.name }}</h4>


<div class="row">

    <!-- KHá»I LÆ¯á»¢NG CÃ”NG VIá»†C -->
    <div class="col-md-4 mb-3">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5>ğŸ“‹ Khá»‘i lÆ°á»£ng cÃ´ng viá»‡c</h5>
                <p class="text-muted small mb-2">
                    Import & quáº£n lÃ½ khá»‘i lÆ°á»£ng tá»« Excel
                </p>
                <a href="{% url 'work_items' project.id %}"
                   class="btn btn-info btn-sm">
                    Má»Ÿ
                </a>
            </div>
        </div>
    </div>

    <!-- NHáº¬T KÃ THI CÃ”NG -->
    <div class="col-md-4 mb-3">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5>ğŸ“˜ Nháº­t kÃ½ thi cÃ´ng</h5>
                <p class="text-muted small mb-2">
                    Ghi nháº­t kÃ½ hÃ ng ngÃ y theo cÃ´ng viá»‡c
                </p>
                <a href="{% url 'daily_log_calendar' project.id %}"
                class="btn btn-primary btn-sm">
                    Má»Ÿ
                </a>

            </div>
        </div>
    </div>

    <!-- KHO Váº¬T TÆ¯ -->
    <div class="col-md-4 mb-3">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5>ğŸ—ï¸ Kho váº­t tÆ°</h5>
                <p class="text-muted small mb-2">
                    Quáº£n lÃ½ xuáº¥t â€“ nháº­p â€“ tá»“n
                </p>
                <a href="{% url 'warehouse' project.id %}"
                   class="btn btn-success btn-sm">
                    Má»Ÿ
                </a>
            </div>
        </div>
    </div>

    <!-- Äá»ŠNH Má»¨C Váº¬T TÆ¯ -->
    <div class="col-md-4 mb-3">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5>ğŸ“ Äá»‹nh má»©c váº­t tÆ°</h5>
                <p class="text-muted small mb-2">
                    Nháº­p Ä‘á»‹nh má»©c váº­t tÆ° theo dá»± Ã¡n
                </p>
                <a href="{% url 'material_norms' project.id %}"
                   class="btn btn-warning btn-sm">
                    Má»Ÿ
                </a>
            </div>
        </div>
    </div>

</div>



<!-- ===== BIá»‚U Äá»’ ===== -->
<div class="card mb-4">
    <div class="card-header bg-danger text-white">
        ğŸ“Š Biá»ƒu Ä‘á»“ vÆ°á»£t Ä‘á»‹nh má»©c váº­t tÆ°
    </div>
    <div class="card-body">

        {% if chart_labels %}
            <div style="height: 420px;">
                <canvas id="materialChart" height="400"></canvas>
            </div>
        {% else %}
            <p class="text-muted mb-0">
                ChÆ°a cÃ³ dá»¯ liá»‡u váº­t tÆ° Ä‘á»ƒ hiá»ƒn thá»‹ biá»ƒu Ä‘á»“
            </p>
        {% endif %}

    </div>
</div>

<!-- ===== TRUYá»€N DATA CHO JS (PHáº¢I TRÆ¯á»šC FILE JS) ===== -->
{% if chart_labels %}
<script>
    window.chartLabels = {{ chart_labels|safe }};
    window.chartPercents = {{ chart_percents|safe }};
    window.chartColors = {{ chart_colors|safe }};
    window.chartMaterialIds = {{ chart_material_ids|safe }};
    window.projectId = {{ project.id }};
</script>
{% endif %}

<!-- ===== LIB & FILE JS ===== -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{% static 'core/js/material_usage_chart.js' %}"></script>

<!-- ===== CHÃš THÃCH ===== -->
<div class="card">
    <div class="card-body">
        <strong>ChÃº thÃ­ch:</strong>
        <ul class="mb-0">
            <li><span style="color:#28a745;">ğŸŸ¢</span> DÆ°á»›i 80% Ä‘á»‹nh má»©c</li>
            <li><span style="color:#ffc107;">ğŸŸ¡</span> 80% â€“ 100% Ä‘á»‹nh má»©c</li>
            <li><span style="color:#dc3545;">ğŸ”´</span> VÆ°á»£t Ä‘á»‹nh má»©c</li>
        </ul>
    </div>
</div>

{% endblock %}