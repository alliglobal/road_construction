{% extends 'core/base.html' %}
{% load static %}
{% load dict_extras %}

{% block content %}
<div class="container mt-4">

    <h3 class="mb-3">
        üìÖ Nh·∫≠t k√Ω thi c√¥ng ‚Äì {{ project.name }}
    </h3>

    <!-- ƒêi·ªÅu h∆∞·ªõng th√°ng -->
        <div class="d-flex justify-content-between align-items-center mb-3">
            <a class="btn btn-outline-secondary btn-sm"
            href="{% url 'daily_log_calendar' project.id prev_year prev_month %}">
                ‚óÄ Th√°ng tr∆∞·ªõc
            </a>

            <h5 class="mb-0">
                üìÖ {{ month }}/{{ year }}
            </h5>

            <a class="btn btn-outline-secondary btn-sm"
            href="{% url 'daily_log_calendar' project.id next_year next_month %}">
                Th√°ng sau ‚ñ∂
            </a>
        </div>


    

    <!-- L·ªäCH -->
    <table class="table table-bordered calendar-table">
        <thead class="table-light text-center">
            <tr>
                <th>CN</th>
                <th>T2</th>
                <th>T3</th>
                <th>T4</th>
                <th>T5</th>
                <th>T6</th>
                <th>T7</th>
            </tr>
        </thead>
        <tbody>
        {% for week in calendar %}
            <tr>
                {% for day in week %}
                    <td class="align-top calendar-cell">
                        {% if day %}
                            <!-- Ng√†y -->
                            <div class="d-flex justify-content-between">
                                <strong>{{ day }}</strong>
                                <a href="{% url 'daily_log_form' project.id year month day %}"
                                   class="text-primary small">
                                    ‚úèÔ∏è
                                </a>
                            </div>

                            <!-- Nh·∫≠t k√Ω trong ng√†y -->
                            {% with log=log_map|dict_get:day %}
                                {% if log %}
                                    <div class="mt-1">
                                        {% for item in log.items.all %}
                                            <div class="small text-success">
                                                ‚ñ™ {{ item.work_item.name }}
                                                : <strong>{{ item.quantity_done }}</strong>
                                            </div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            {% endwith %}
                        {% endif %}
                    </td>
                {% endfor %}
            </tr>
        {% endfor %}
        </tbody>
    </table>

</div>

<style>
.calendar-table {
    table-layout: fixed;
}
.calendar-cell {
    height: 130px;
    vertical-align: top;
    font-size: 14px;
}
.calendar-cell:hover {
    background-color: #f8f9fa;
}
</style>
{% endblock %}
